<!DOCTYPE html>
<html>
<head>
    <title>Direct Search Test - Shipments</title>
</head>
<body>
    <h1>Testing Search Function - Real Data</h1>
    <div id="results"></div>
    
    <script>
    async function testSearch() {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '<p>Testing search for "Air" in shipments...</p>';
        
        try {
            const response = await fetch('https://zupuxlrtixhfnbuhxhum.supabase.co/functions/v1/search-run', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6IlQxOXlrekV2eHJQQUd2VWQiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3p1cHV4bHJ0aXhoZm5idWh4aHVtLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiJiYjk5N2I2Yi1mYTFhLTQ2YzgtOTk1Ny1mYWJlODM1ZWVlNTUiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzU1NTg4Njc4LCJpYXQiOjE3NTU1ODUwNzgsImVtYWlsIjoiaW5mb0BnZXRiM2Fjb24uY29tIiwicGhvbmUiOiIiLCJhcHBfbWV0YWRhdGEiOnsicHJvdmlkZXIiOiJlbWFpbCIsInByb3ZpZGVycyI6WyJlbWFpbCJdfSwidXNlcl9tZXRhZGF0YSI6eyJhZG1pbl9sZXZlbCI6ImZ1bGwiLCJjb21wYW55IjoiTG9naXN0aWMgSW50ZWwiLCJmdWxsX25hbWUiOiJBZG1pbiBUZXN0IFVzZXIiLCJwbGFuIjoiZW50ZXJwcmlzZSIsInJvbGUiOiJhZG1pbiJ9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6InBhc3N3b3JkIiwidGltZXN0YW1wIjoxNzU1NTg1MDc4fV0sInNlc3Npb25faWQiOiJlZjI0MzMwMC0yOWUxLTQ5NzUtOTkwYi0yYTY1Mzg4MjhhMzUiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.VRpC314xApVjD1GYLs3JSmuwR5Ds3zCkm_KUOtkVvSs',
                    'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp1cHV4bHJ0aXhoZm5idWh4aHVtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0MzkyMTYsImV4cCI6MjA3MDAxNTIxNn0.cuKMT_qhg8uOjFImnbQreg09K-TnVqV_NE_E5ngsQw0'
                },
                body: JSON.stringify({
                    q: 'Air',
                    tab: 'shipments'
                })
            });
            
            const data = await response.json();
            
            document.getElementById('results').innerHTML = `
                <h3>üîç Search Test Results:</h3>
                <p><strong>Status:</strong> ${response.ok ? '‚úÖ SUCCESS' : '‚ùå FAILED'} (${response.status})</p>
                <p><strong>Query:</strong> "Air" in shipments tab</p>
                <p><strong>Total Results:</strong> ${data.total || 0}</p>
                
                <h4>üì¶ Shipment Records Found:</h4>
                ${data.items && data.items.length > 0 ? `
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        ${data.items.map((item, index) => `
                            <div style="border: 1px solid #ddd; padding: 10px; margin: 8px 0; border-radius: 5px; background: white;">
                                <h5>Shipment ${index + 1}:</h5>
                                <p><strong>Company:</strong> ${item.company || 'N/A'}</p>
                                <p><strong>Mode:</strong> ${item.mode || 'N/A'}</p>
                                <p><strong>HS Code:</strong> ${item.hs_code || 'N/A'}</p>
                                <p><strong>Origin:</strong> ${item.origin || 'N/A'}</p>
                                <p><strong>Destination:</strong> ${item.destination || 'N/A'}</p>
                                <p><strong>Value:</strong> ${item.value || 'N/A'}</p>
                                <p><strong>Date:</strong> ${item.date || 'N/A'}</p>
                                <p><strong>Carrier:</strong> ${item.carrier || 'N/A'}</p>
                                <p><strong>Description:</strong> ${item.description || 'N/A'}</p>
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <p style="color: orange;">‚ö†Ô∏è No shipments found for "Air"</p>
                `}
                
                <details style="margin-top: 20px;">
                    <summary><strong>üîç Raw API Response</strong></summary>
                    <pre style="background: #f5f5f5; padding: 10px; border-radius: 5px; overflow-x: auto;">${JSON.stringify(data, null, 2)}</pre>
                </details>
            `;
            
        } catch (error) {
            document.getElementById('results').innerHTML = `
                <h3>‚ùå Test Failed</h3>
                <p style="color: red;"><strong>Error:</strong> ${error.message}</p>
                <p>This indicates a connection or API issue.</p>
            `;
        }
    }
    
    // Run test immediately when page loads
    testSearch();
    </script>
</body>
</html>